{"ast":null,"code":"var _jsxFileName = \"/home/pat/Desktop/penny_stocks/web/src/cards/CardLineChart.js\";\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { ComposedChart, Line, Area, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, Scatter, ResponsiveContainer } from 'recharts';\nimport { faArrowCircleRight, faArrowCircleLeft } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { connect } from \"react-redux\";\nimport { getData, addLineData, addMasterLineData } from \"../js/actions/index\";\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    addLineData: cardLineData => dispatch(addLineData(cardLineData)),\n    addMasterLineData: masterCardLineData => dispatch(addMasterLineData(masterCardLineData))\n  };\n}\n\nfunction CardLineChart(props) {\n  const [data, setData] = useState([]);\n  const [master, setMaster] = useState([]); //const [refAreaLeft, setRefAreaLeft] = useState('');\n  //const [refAreaRight, setRefAreaRight] = useState('');\n\n  const refAreaLeft = useRef('');\n  const refAreaRight = useRef(''); //const moveRight = useRef('false');\n\n  const zoomIn = useRef('false');\n  const [refArea, setRefArea] = useState([]); //const [zoomIn, setZoomIn] = useState('false');\n\n  const [moveRight, setMoveRight] = useState('false');\n  useEffect(() => {\n    props.getData();\n  }, []);\n  useEffect(() => {\n    console.log('ceejwgcjhjhccjhj', props.dataAO);\n    formatData(props.dataAO);\n    makeMaster(props.dataAO);\n  }, [props.dataAO]);\n  useEffect(() => {\n    console.log('effect', props.data, props.masterData);\n  }, [props.data, props.masterData]);\n  useEffect(() => {\n    console.log('zoooooom');\n    zoom();\n  }, [refAreaRight]);\n\n  function makeMaster(dats) {\n    const arr = [];\n\n    for (let x = 0; x < dats.length; x++) {\n      const ao = parseFloat(dats[x][0].split('/')[0]);\n      const price = parseFloat(dats[x][4].split(':')[1]);\n      const dic = {\n        'ticker': dats[x][1].split(':')[1].split('/')[0],\n        'ao': parseFloat(dats[x][0].split('/')[0]) > 10 || parseFloat(dats[x][0].split('/')[0]) < -10 ? parseFloat(dats[x][0].split('/')[0]) < 0 ? -5 : 5 : parseFloat(dats[x][0].split('/')[0]),\n        'price': parseFloat(dats[x][4].split(':')[1]),\n        'percent': Math.abs(Math.round(ao / price * 100000) / 1000) > 1 ? 1 : Math.abs(Math.round(ao / price * 100000) / 1000) * 5\n      };\n      arr.push(dic);\n    }\n\n    props.addMasterLineData(arr); //setMaster(prev => arr)\n  }\n\n  function formatData(dats, _ind) {\n    const arr = [];\n\n    for (let x = 0; x < dats.length; x++) {\n      const ao = parseFloat(dats[x][0].split('/')[0]);\n      const price = parseFloat(dats[x][4].split(':')[1]);\n      const dic = {\n        'ticker': dats[x][1].split(':')[1].split('/')[0],\n        'ao': parseFloat(dats[x][0].split('/')[0]) > 10 || parseFloat(dats[x][0].split('/')[0]) < -10 ? parseFloat(dats[x][0].split('/')[0]) < 0 ? -5 : 5 : parseFloat(dats[x][0].split('/')[0]),\n        'price': parseFloat(dats[x][4].split(':')[1]),\n        'percent': Math.abs(Math.round(ao / price * 100000) / 1000) > 1 ? 1 : Math.abs(Math.round(ao / price * 100000) / 1000) * 5\n      };\n      arr.push(dic);\n    }\n\n    ;\n    props.addLineData(arr);\n  }\n\n  ;\n\n  function zoom() {\n    const arr = [];\n    console.log('lefffff', refAreaLeft.current);\n    console.log('riiigh', refAreaRight.current);\n\n    for (let i = 0; i < props.masterData.length; i++) {\n      if (props.masterData[i].ticker === refAreaRight.current || props.masterData[i].ticker === refAreaLeft.current) {\n        arr.push(i);\n      }\n    }\n\n    ;\n    console.log('ind_arr', arr);\n\n    if (zoomIn.current === 'false') {\n      zoomIn.current = 'true';\n    }\n\n    ;\n    const ar = props.masterData.slice(arr[0], arr[1]);\n    props.addLineData(ar);\n    /*\n    ///console.log('left', refAreaLeft);\n    console.log('right', right);\n    console.log(9999999999999, _left)\n    console.log(master)\n    //setData([]);\n    const arr = [];\n    const left = (_left !== undefined) ?_left : refAreaLeft;\n    console.log('_lefffff', _left)\n    for(let i=0;i<master.length;i++){\n      if(master[i].ticker === right || master[i].ticker === left){\n        console.log(i)\n        arr.push(i)\n      }\n    }\n    console.log(arr);\n    if(moveRight === 'false'){\n      setZoomIn(prev => 'true')\n      const ar = master.slice(arr[0], arr[1])\n      const res = [];\n      for(let x=0;x<ar.length;x++){\n        ///data.push(arr[x])\n        res.push(ar[x]);\n      }\n      setData(prev => ar);\n      //setRefAreaLeft(prev => master[arr[0]]['ticker'])\n      ///setData(prev => [...prev]);\n      console.log(data);\n    };\n    if(moveRight === 'true'){\n      setZoomIn(prev => 'true')\n      const ar = master.slice(arr[0], arr[1]);\n      const datas = [...data]\n      datas.push(master[arr[1]]);\n      datas.pop(0);\n      setData(prev => datas)\n      /*\n      const res = [];\n      for(let x=0;x<ar.length;x++){\n        ///data.push(arr[x])\n        res.push(ar[x]);\n      }\n      setData(prev => ar);\n      //setRefAreaLeft(prev => master[arr[0]]['ticker'])\n      ///setData(prev => [...prev]);\n      console.log(data);\n      \n    }\n    */\n  }\n\n  ;\n\n  function zoomOut() {\n    zoomIn.current = 'false';\n    formatData(props.mas);\n  }\n\n  ;\n\n  function panLeft() {\n    if (zoomIn.current === 'true') {\n      moveRight = 'true';\n\n      while (moveRight === 'true') {\n        setInterval(() => {\n          console.log(2);\n        }, 500);\n      }\n    }\n\n    ;\n  }\n\n  function panRight() {\n    if (zoomIn.current === 'true') {\n      //console.log('panr ref',data[0]['ticker']);\n      //console.log('left', refAreaLeft)\n      for (let i = 0; i < master.length; i++) {\n        if (master[i]['ticker'] === refAreaLeft.current) {\n          refAreaLeft.current = master[i + 1]['ticker']; //setRefAreaLeft(prev => master[i+1]['ticker']);\n          //console.log('master_left', master[i+1]['ticker']);\n        }\n\n        ;\n        console.log(data[data.length - 1]['ticker'], 'last');\n\n        if (master[i]['ticker'] === refAreaRight.current) {\n          refAreaRight.current = master[i + 1]['ticker']; //setRefAreaRight(prev => master[i+1]['ticker'])\n          //console.log('right', master[i]['ticker'])\n          //setMoveRight(prev => 'false')\n          //console.log(2222222222222222, master[i+1]['ticker'])\n        }\n      }\n\n      ; //console.log('new_refs', right);\n      ///setRefArea(prev => new_refs)\n\n      zoom();\n    }\n  }\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      if (moveRight === 'true') {\n        panRight();\n      }\n\n      ;\n\n      if (moveRight === 'false') {\n        return () => clearInterval(timer);\n      }\n\n      ;\n    }, 5000); // clearing interval\n\n    return () => clearInterval(timer);\n  }, [moveRight]);\n\n  function zooming(e) {\n    zoomIn.current = 'true';\n    refAreaRight.current = e.activeLabel;\n    zoom();\n  }\n\n  ;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '100%',\n      height: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: 'absolute'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: zoomOut,\n    type: \"button\",\n    className: \"btn update\",\n    style: {\n      position: 'absolute',\n      zIndex: '1',\n      backgroundColor: 'darkgray'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 9\n    }\n  }, \"Zoom Out\"), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '15vh'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(ResponsiveContainer, {\n    width: \"100%\",\n    height: \"100%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ComposedChart, {\n    onMouseDown: e => refAreaLeft.current = e.activeLabel // eslint-disable-next-line react/jsx-no-bind\n    ,\n    onMouseUp: e => zooming(e),\n    width: 500,\n    height: 1000,\n    data: props.data,\n    style: {\n      backgroundColor: '#202020'\n    },\n    margin: {\n      top: 20,\n      right: 20,\n      bottom: 20,\n      left: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(XAxis, {\n    dataKey: \"ticker\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(YAxis, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Tooltip, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Legend, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Bar, {\n    dataKey: \"ao\",\n    barSize: 20,\n    fill: \"#FF0000\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Bar, {\n    dataKey: \"percent\",\n    barSize: 20,\n    fill: \"#C000FF\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Scatter, {\n    dataKey: \"percent\",\n    fill: \"#C000FF\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Scatter, {\n    dataKey: \"price\",\n    fill: \"#40FF40\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 11\n    }\n  })))));\n}\n\nfunction mapStateToProps(state) {\n  return {\n    dataAO: state.remoteAOData,\n    data: state.cardLineData,\n    masterData: state.masterCardLineData\n  };\n}\n\nexport default connect(mapStateToProps, {\n  getData,\n  addLineData,\n  addMasterLineData\n})(CardLineChart);","map":{"version":3,"sources":["/home/pat/Desktop/penny_stocks/web/src/cards/CardLineChart.js"],"names":["React","useEffect","useState","useRef","ComposedChart","Line","Area","Bar","XAxis","YAxis","CartesianGrid","Tooltip","Legend","Scatter","ResponsiveContainer","faArrowCircleRight","faArrowCircleLeft","FontAwesomeIcon","connect","getData","addLineData","addMasterLineData","mapDispatchToProps","dispatch","cardLineData","masterCardLineData","CardLineChart","props","data","setData","master","setMaster","refAreaLeft","refAreaRight","zoomIn","refArea","setRefArea","moveRight","setMoveRight","console","log","dataAO","formatData","makeMaster","masterData","zoom","dats","arr","x","length","ao","parseFloat","split","price","dic","Math","abs","round","push","_ind","current","i","ticker","ar","slice","zoomOut","mas","panLeft","setInterval","panRight","timer","clearInterval","zooming","e","activeLabel","width","height","position","zIndex","backgroundColor","top","right","bottom","left","mapStateToProps","state","remoteAOData"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport {\n  ComposedChart,\n  Line,\n  Area,\n  Bar,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  Legend,\n  Scatter,\n  ResponsiveContainer,\n} from 'recharts';\n\nimport { faArrowCircleRight, faArrowCircleLeft } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { connect } from \"react-redux\";\nimport { getData, addLineData, addMasterLineData } from \"../js/actions/index\";\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    addLineData: cardLineData => dispatch(addLineData(cardLineData)),\n    addMasterLineData: masterCardLineData => dispatch(addMasterLineData(masterCardLineData))\n\n  };\n}\n\nfunction CardLineChart(props) {\n  const [data, setData] = useState([]);\n  const [master, setMaster] = useState([]);\n  //const [refAreaLeft, setRefAreaLeft] = useState('');\n  //const [refAreaRight, setRefAreaRight] = useState('');\n  const refAreaLeft = useRef('');\n  const refAreaRight = useRef('');\n  //const moveRight = useRef('false');\n  const zoomIn = useRef('false');\n  const [refArea, setRefArea] = useState([]);\n  //const [zoomIn, setZoomIn] = useState('false');\n  const [moveRight, setMoveRight] = useState('false');\n  useEffect(() => {\n    props.getData();\n  }, [])\n  useEffect(() => {\n    console.log('ceejwgcjhjhccjhj', props.dataAO)\n    formatData(props.dataAO);\n    makeMaster(props.dataAO);\n  }, [props.dataAO])\n\n  useEffect(() => {\n    console.log('effect', props.data, props.masterData);\n  },[props.data, props.masterData]);\n  useEffect(() => {\n    console.log('zoooooom')\n    zoom();\n  }, [refAreaRight])\n  function makeMaster(dats){\n    const arr = [];\n    for(let x=0;x<dats.length;x++){\n      const ao = parseFloat(dats[x][0].split('/')[0]);\n      const price = parseFloat(dats[x][4].split(':')[1]);\n      const dic = {\n        'ticker': dats[x][1].split(':')[1].split('/')[0],\n        'ao': ((parseFloat(dats[x][0].split('/')[0]) > 10) || (parseFloat(dats[x][0].split('/')[0]) < -10)) ? parseFloat(dats[x][0].split('/')[0]) < 0 ? -5:5 : parseFloat(dats[x][0].split('/')[0]),\n        'price': parseFloat(dats[x][4].split(':')[1]),\n        'percent': Math.abs(Math.round(ao/price * 100000) / 1000) > 1 ? 1: Math.abs(Math.round(ao/price * 100000) / 1000) * 5\n      };\n      arr.push(dic)\n    }\n    props.addMasterLineData(arr);\n    //setMaster(prev => arr)\n  }\n  function formatData(dats, _ind){\n    const arr = [];\n    for(let x=0;x<dats.length;x++){\n      const ao = parseFloat(dats[x][0].split('/')[0]);\n      const price = parseFloat(dats[x][4].split(':')[1]);\n      const dic = {\n        'ticker': dats[x][1].split(':')[1].split('/')[0],\n        'ao': ((parseFloat(dats[x][0].split('/')[0]) > 10) || (parseFloat(dats[x][0].split('/')[0]) < -10)) ? parseFloat(dats[x][0].split('/')[0]) < 0 ? -5:5 : parseFloat(dats[x][0].split('/')[0]),\n        'price': parseFloat(dats[x][4].split(':')[1]),\n        'percent': Math.abs(Math.round(ao/price * 100000) / 1000) > 1 ? 1: Math.abs(Math.round(ao/price * 100000) / 1000) * 5\n      };\n      arr.push(dic)\n    };\n    props.addLineData(arr);\n  };\n  function zoom(){\n    const arr = [];\n    console.log('lefffff', refAreaLeft.current);\n    console.log('riiigh', refAreaRight.current);\n    for(let i=0;i<props.masterData.length;i++){\n      if(props.masterData[i].ticker === refAreaRight.current || props.masterData[i].ticker === refAreaLeft.current){\n        arr.push(i)\n      }\n    };\n    console.log('ind_arr', arr);\n    if(zoomIn.current === 'false'){\n      zoomIn.current = 'true';\n    };\n    const ar = props.masterData.slice(arr[0], arr[1]);\n    props.addLineData(ar);\n\n\n\n\n\n\n\n    /*\n    ///console.log('left', refAreaLeft);\n    console.log('right', right);\n    console.log(9999999999999, _left)\n    console.log(master)\n    //setData([]);\n    const arr = [];\n    const left = (_left !== undefined) ?_left : refAreaLeft;\n    console.log('_lefffff', _left)\n    for(let i=0;i<master.length;i++){\n      if(master[i].ticker === right || master[i].ticker === left){\n        console.log(i)\n        arr.push(i)\n      }\n    }\n    console.log(arr);\n    if(moveRight === 'false'){\n      setZoomIn(prev => 'true')\n      const ar = master.slice(arr[0], arr[1])\n      const res = [];\n      for(let x=0;x<ar.length;x++){\n        ///data.push(arr[x])\n        res.push(ar[x]);\n      }\n      setData(prev => ar);\n      //setRefAreaLeft(prev => master[arr[0]]['ticker'])\n      ///setData(prev => [...prev]);\n      console.log(data);\n    };\n    if(moveRight === 'true'){\n      setZoomIn(prev => 'true')\n      const ar = master.slice(arr[0], arr[1]);\n      const datas = [...data]\n      datas.push(master[arr[1]]);\n      datas.pop(0);\n      setData(prev => datas)\n      /*\n      const res = [];\n      for(let x=0;x<ar.length;x++){\n        ///data.push(arr[x])\n        res.push(ar[x]);\n      }\n      setData(prev => ar);\n      //setRefAreaLeft(prev => master[arr[0]]['ticker'])\n      ///setData(prev => [...prev]);\n      console.log(data);\n      \n    }\n    */\n  };\n  function zoomOut(){\n    zoomIn.current = 'false'; \n    formatData(props.mas);\n  };\n  function panLeft(){\n    if(zoomIn.current === 'true'){\n      moveRight = 'true';\n      while(moveRight === 'true'){\n        setInterval(() => {\n          console.log(2)\n        }, 500);\n    }\n  };\n}\n  function panRight(){\n    if(zoomIn.current === 'true'){\n      //console.log('panr ref',data[0]['ticker']);\n      //console.log('left', refAreaLeft)\n      for(let i=0;i<master.length;i++){\n        if(master[i]['ticker'] === refAreaLeft.current){\n          refAreaLeft.current = master[i+1]['ticker'];\n          //setRefAreaLeft(prev => master[i+1]['ticker']);\n          //console.log('master_left', master[i+1]['ticker']);\n        };\n        console.log(data[data.length-1]['ticker'], 'last')\n        if(master[i]['ticker'] === refAreaRight.current){\n          refAreaRight.current = master[i+1]['ticker'];\n          //setRefAreaRight(prev => master[i+1]['ticker'])\n          //console.log('right', master[i]['ticker'])\n          //setMoveRight(prev => 'false')\n          //console.log(2222222222222222, master[i+1]['ticker'])\n        }\n      };\n      //console.log('new_refs', right);\n      ///setRefArea(prev => new_refs)\n      zoom()\n    }\n  }\n\n  useEffect(() => {\n    const timer = setInterval(() => {      \n      if(moveRight === 'true'){\n        panRight();\n      };\n      if(moveRight === 'false'){\n        return () => clearInterval(timer);\n      };     \n    }, 5000);               // clearing interval\n    return () => clearInterval(timer);\n  }, [moveRight])\n  function zooming(e){\n    zoomIn.current = 'true';\n    refAreaRight.current= e.activeLabel;\n    zoom();\n  };\n  return (\n    <>\n    <div style={{ width: '100%', height: '100%'}}>\n      <div style={{ position: 'absolute'}}>\n        <button onClick={zoomOut} type=\"button\" className=\"btn update\" style={{ position: 'absolute', zIndex: '1', backgroundColor: 'darkgray'}}>\n            Zoom Out\n        </button>\n        <div style={{ height: '15vh'}}></div>\n\n\n      </div>\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <ComposedChart\n          onMouseDown={(e) => refAreaLeft.current= e.activeLabel}\n          // eslint-disable-next-line react/jsx-no-bind\n          onMouseUp={(e) => zooming(e)}\n          width={500}\n          height={1000}\n          data={props.data}\n          style={{\n            backgroundColor: '#202020',\n          }}\n          margin={{\n            top: 20,\n            right: 20,\n            bottom: 20,\n            left: 20,\n          }}\n        >\n          <XAxis dataKey=\"ticker\"  />\n          <YAxis />\n          <Tooltip />\n          <Legend />\n          <Bar dataKey=\"ao\" barSize={20} fill=\"#FF0000\" />\n          <Bar dataKey=\"percent\" barSize={20} fill=\"#C000FF\" />\n          <Scatter dataKey=\"percent\" fill=\"#C000FF\" />\n          <Scatter dataKey=\"price\" fill=\"#40FF40\" />\n        </ComposedChart>\n      </ResponsiveContainer>\n    </div>\n\n    </>\n  );\n}\n\nfunction mapStateToProps(state) {\n  return {\n    dataAO: state.remoteAOData,\n    data: state.cardLineData,\n    masterData: state.masterCardLineData\n  };\n}\n\n\nexport default connect(\n  mapStateToProps,\n  { getData, addLineData, addMasterLineData }\n)(CardLineChart);"]},"metadata":{},"sourceType":"module"}